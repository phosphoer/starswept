function addProperty(t,e,n,i){var o=t[e],r=function(){return n.apply(t,[o])},s=function(e){return o=i.apply(t,[e])};if(Object.defineProperty)Object.defineProperty(t,e,{get:r,set:s});else if(t.__defineGetter__)t.__defineGetter__(e,r),t.__defineSetter__(e,s);else{var a=function(){if(event.propertyName==e){t.detachEvent("onpropertychange",a);{s(t[e])}t[e]=r,t[e].toString=r,t.attachEvent("onpropertychange",a)}};t[e]=r,t[e].toString=r,t.attachEvent("onpropertychange",a)}}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),function(t){!function(t,e){t.angleToPoint=function(t,n){return e.atan2(n[1]-t[1],n[0]-t[0])},t.pointDistancePoint=function(t,n){return e.sqrt((t[0]-n[0])*(t[0]-n[0])+(t[1]-n[1])*(t[1]-n[1]))},t.pointInRect=function(t,e,n){return t[0]<e[0]||t[1]<e[1]?!1:t[0]>n[0]||t[1]>n[1]?!1:!0},t.pointInCircle=function(e,n,i){return t.pointDistancePoint(e,n)<=i}}(t.Math=t.Math||{},Math)}(this.TANK=this.TANK||{}),function(t){!function(t){t.LEFT_MOUSE=0,t.MIDDLE_MOUSE=1,t.RIGHT_MOUSE=2,t.LEFT_ARROW=37,t.UP_ARROW=38,t.RIGHT_ARROW=39,t.DOWN_ARROW=40,t.SHIFT=16,t.BACKSPACE=8,t.ESCAPE=27,t.SPACE=32,t.CONTROL=17,t.ALT=18,t.SUPER=91,t.TILDE=192,t.A=65,t.B=66,t.C=67,t.D=68,t.E=69,t.F=70,t.G=71,t.H=72,t.I=73,t.J=74,t.K=75,t.L=76,t.M=77,t.N=78,t.O=79,t.P=80,t.Q=81,t.R=82,t.S=83,t.T=84,t.U=85,t.V=86,t.W=87,t.X=88,t.Y=89,t.Z=90,t.NUM1=49,t.NUM2=50,t.NUM3=51,t.NUM4=52,t.NUM5=53,t.NUM6=54,t.NUM7=55,t.NUM8=56,t.NUM9=57,t.NUM0=48}(t.Key=t.Key||{})}(this.TANK=this.TANK||{}),function(t){"use strict";t.Component=function(t){this.name=t,this.parent=null,this._functions={},this._includes=[],this._interfaces=[]},t.Component.prototype.clone=function(){var t={};t.construct=function(){},t.initialize=function(){},t.destruct=function(){},t.interfaces={};var e;for(e=0;e<this._interfaces.length;++e)t.interfaces[this._interfaces[e]]=!0;for(e in this._functions)this._functions.hasOwnProperty(e)&&(t[e]=this._functions[e]);return t.name=this.name,t._constructed=!1,t.addEventListener=this.addEventListener,t.removeEventListener=this.removeEventListener,t._listeners=[],t},t.Component.prototype.requires=function(){var t,e,n;for(t=0;t<arguments.length;++t){n=arguments[t],n=n.replace(/\s/g,"");var i=n.split(",");for(e=0;e<i.length;++e)this._includes.push(i[e])}return this},t.Component.prototype.interfaces=function(){var t,e,n;for(t=0;t<arguments.length;++t){n=arguments[t],n=n.replace(/\s/g,"");var i=n.split(",");for(e=0;e<i.length;++e)this._interfaces.push(i[e])}return this},t.Component.prototype.construct=function(t){return this._functions.construct=t,this},t.Component.prototype.initialize=function(t){return this._functions.initialize=t,this},t.Component.prototype.destruct=function(t){return this._functions.destruct=t,this},t.Component.prototype.addEventListener=function(e,n){if(this._functions)return void t.error("The component "+this.name+"tried to listen to "+e+"before it was instantiated.");if(!this._constructed)return void t.error("The component "+this.name+" tried to listen to "+e+" from `construct`, but should do so from `initialize` instead");if(!n||!n.apply)return void t.error("The component "+this.name+" tried to listen to "+e+" but did not supply a valid callback");var i=this.space._events[e];i||(i=[],this.space._events[e]=i),this._listeners.push({evt:e,self:this,func:n}),i.push({self:this,func:n})},t.Component.prototype.removeEventListener=function(e,n){if(this._functions)return void t.error("The component "+this.name+"tried to stop listening to "+e+"before it was instantiated.");if(!this._constructed)return void t.error("The component "+this.name+" tried to stop listening to "+e+" from `construct`, but should do so from `initialize` instead");if(!n||!n.apply)return void t.error("The component "+this.name+" tried to stop listening to "+e+" but did not supply a valid callback");var i,o=this.space._events[e];if(o){for(i=0;i<this._listeners.length;++i)if(this._listeners[i].evt===e&&this._listeners[i].func===n){this._listeners.splice(i,1);break}for(i=0;i<o.length;++i)if(o[i].self===this&&o[i].func===n){o.splice(i,1);break}}}}(this.TANK=this.TANK||{}),function(t){"use strict";t.Entity=function(t){this.name=null,this.id=t,this.space=null,this._components={},this._orderedComponents=[],this._initialized=!1,this._numComponents=0},t.Entity.prototype.addComponent=function(e){if(this[e])return this;var n=t._registeredComponents[e];if(!n)return t.error("No component registered with name "+e),this;this[e]="Placeholder",this._components[e]="Placeholder";var i;for(i=0;i<n._includes.length;++i)this.addComponent(n._includes[i]);var o=n.clone();return this[e]=o,this._orderedComponents.push(o),this._components[e]=o,o.construct(),o._constructed=!0,o._order=this._numComponents++,o.parent=this,o.space=this.space,this._initialized&&(this.trackInterface(e),o.initialize(),this.space.dispatchEvent("OnComponentInitialized",o)),this},t.Entity.prototype.addComponents=function(){var t,e,n;for(t=0;t<arguments.length;++t){n=arguments[t],n=n.replace(/\s/g,"");var i=n.split(",");for(e=0;e<i.length;++e)this.addComponent(i[e])}return this},t.Entity.prototype.removeComponent=function(e,n){var i=this[e];if(i){this.space.dispatchEvent("OnComponentUninitialized",i),i.destruct();var o,r,s,a;for(o=0;o<i._listeners.length;++o)for(s=i._listeners[o],a=this.space._events[s.evt],r=0;a&&r<a.length;++r)if(a[r].self===s.self&&a[r].func===s.func){a.splice(r,1);break}var p=t._registeredComponents[e];for(o=0;o<p._interfaces.length;++o){var c=this.space._interfaceComponents[p._interfaces[o]];c&&delete c[this.name+"."+p.name]}n||(this._orderedComponents.splice(i._order,1),delete this._components[e],delete this[e])}},t.Entity.prototype.invoke=function(t){var e,n=[];for(e=1;e<arguments.length;++e)n.push(arguments[e]);for(e in this._components)this._components.hasOwnProperty(e)&&this._components[e][t]&&this._components[e][t].apply&&this._components[e][t].apply(this._components[e],n);return this},t.Entity.prototype.initialize=function(){var t,e;for(t in this._components)this.trackInterface(t);for(t=0;t<this._orderedComponents.length;++t)e=this._orderedComponents[t],e.space=this.space,e.initialize();for(t=0;t<this._orderedComponents.length;++t)e=this._orderedComponents[t],this.space.dispatchEvent("OnComponentInitialized",e);return this._initialized=!0,this},t.Entity.prototype.destruct=function(){var t;for(t=this._orderedComponents.length-1;t>=0;--t)this.removeComponent(this._orderedComponents[t].name,!0);return this._initialized=!1,this},t.Entity.prototype.trackInterface=function(e){var n,i=this[e];n=t._registeredComponents[e];for(var o=0;o<n._interfaces.length;++o){var r=this.space._interfaceComponents[n._interfaces[o]];r||(r={},this.space._interfaceComponents[n._interfaces[o]]=r),r[this.name+"."+n.name]=i}}}(this.TANK=this.TANK||{}),function(t){"use strict";t.Space=function(){this.name=null,this.space=this,this.paused=!1,this._initialized=!1,this._objects={},this._objectsNamed={},this._objectsDeleted=[],this._components={},this._orderedComponents=[],this._numComponents=0,this._interfaceComponents={},this._events={}},t.Space.prototype.addComponent=t.Entity.prototype.addComponent,t.Space.prototype.addComponents=t.Entity.prototype.addComponents,t.Space.prototype.removeComponent=t.Entity.prototype.removeComponent,t.Space.prototype.invoke=t.Entity.prototype.invoke,t.Space.prototype.destruct=t.Entity.prototype.destruct,t.Space.prototype.addEntity=function(e,n){if(-1!==e.id)return t.error("Attempting to add a Entity twice"),e;if(e.id=t._currentID++,e.space=this,null===e.name&&(e.name="Entity "+e.id),n){if(e.name=n,this._objectsNamed[n])return t.error("An Entity named "+n+" already exists"),e;this._objectsNamed[n]=e}return this._objects[e.id]=e,e.initialize(),e},t.Space.prototype.getEntity=function(e){return"string"==typeof e?this._objectsNamed[e]:"number"==typeof e?this._objects[e]:void t.error("Attemping to get an Entity with neither a string name nor an id number: "+e)},t.Space.prototype.removeEntity=function(e){if("string"==typeof e||"number"==typeof e){var n=this.getEntity(e);n?this._objectsDeleted.push(this.getEntity(e)):t.error("Attempting to remove Entity "+e+" which doesn't exist.")}else e instanceof t.Entity?this._objectsDeleted.push(e):t.error("Attemping to remove an Entity with neither a string name, id number, or Entity reference: "+e)},t.Space.prototype.removeAllEntities=function(){var t;for(t in this._objects)this._objects.hasOwnProperty(t)&&this.removeEntity(parseInt(t,10))},t.Space.prototype.getComponentsWithInterface=function(t){return this._interfaceComponents[t]},t.Space.prototype.dispatchEvent=function(e){var n=this._events[e];if(n){for(var i=[],o=1;o<arguments.length;++o)i.push(arguments[o]);var r,s;for(var o in n)r=n[o].func,s=n[o].self,r&&r.apply?r.apply(s,i):t.error(s.name+" is listening for "+e+" but the supplied method is no longer valid")}},t.Space.prototype.clearDeletedObjects=function(){for(var t=0;t<this._objectsDeleted.length;++t){var e=this._objectsDeleted[t];e.destruct(),delete this._objects[e.id],delete this._objectsNamed[e.name],e.id=-1}this._objectsDeleted=[]},t.Space.prototype.update=function(t){if(!this.paused){for(var e=0;e<this._orderedComponents.length;++e){var n=this._orderedComponents[e];n.update&&n.update(t),this.dispatchEvent(n.name+"PostUpdate",t)}this.dispatchEvent("OnEnterFrame",t)}}}(this.TANK=this.TANK||{}),function(t){"use strict";function e(){var n=new Date,i=(n-t._lastTime)/1e3;t._lastTime=n,i>.05&&(i=.05),t.clearDeletedObjects();for(var o in t._spaces)t._spaces.hasOwnProperty(o)&&t._spaces[o].clearDeletedObjects();if(t._resetting){t.destruct();for(var o in t._spaces)t._spaces[o].destruct(),delete t[o];return t._spaces={},t._resetting=!1,t._running=!1,void(t._entryPointFunc&&t._entryPointFunc())}t.update(i);for(var o in t._spaces)t._spaces.hasOwnProperty(o)&&t._spaces[o].update(i);t._running&&requestAnimFrame(e)}t.errorsEnabled=!0,t.warningsEnabled=!0,t.logsEnabled=!0,t.createEntity=function(){var e=new t.Entity(-1);return e.addComponents.apply(e,arguments)},t.createEntityFromPrefab=function(e){var n=t.getPrefab(e);return n?n.apply?n():void t.error("Prefab function supplied for "+e+" is not a function: "+n):void t.error("Could not find a prefab named "+e)},t.addEntity=t.Space.prototype.addEntity,t.getEntity=t.Space.prototype.getEntity,t.removeEntity=t.Space.prototype.removeEntity,t.removeAllEntities=t.Space.prototype.removeAllEntities,t.addComponent=t.Entity.prototype.addComponent,t.addComponents=t.Entity.prototype.addComponents,t.removeComponent=t.Entity.prototype.removeComponent,t.getComponentsWithInterface=t.Space.prototype.getComponentsWithInterface,t.initialize=t.Entity.prototype.initialize,t.destruct=t.Entity.prototype.destruct,t.invoke=t.Entity.prototype.invoke,t.dispatchEvent=t.Space.prototype.dispatchEvent,t.clearDeletedObjects=t.Space.prototype.clearDeletedObjects,t.trackInterface=t.Entity.prototype.trackInterface,t.update=t.Space.prototype.update,t.addPrefab=function(e,n){t._prefabs[e]=n},t.getPrefab=function(e){return t._prefabs[e]},t.registerComponent=function(e){if(e[0]>=0&&e[0]<=9||e.search(" ")>=0)return void t.error(e+" is an invalid identifier and won't be accessible without [] operator");var n=new t.Component(e);return t._registeredComponents[e]=n,n},t.start=function(){t._lastTime=new Date,t._running=!0,t.initialize(),t.log("TankJS has been started"),e()},t.stop=function(){t._running=!1},t.reset=function(e){t._entryPointFunc=e,t._resetting=!0,t.removeAllEntities();for(var n in t._spaces)t._spaces[n].removeAllEntities()},t.log=function(e){t.logsEnabled&&console.log(e)},t.warn=function(e){t.warningsEnabled&&console.warn(e)},t.error=function(e){t.errorsEnabled&&console.error(e)},t._prefabs={},t._spaces={},t._spacesDeleted=[],t._registeredComponents={},t._currentID=0,t._lastTime=new Date,t._running=!1,t._resetting=!1,t.name="TANK",t.space=t,t.paused=!1,t._initialized=!1,t._objects={},t._objectsNamed={},t._objectsDeleted=[],t._components={},t._orderedComponents=[],t._numComponents=0,t._interfaceComponents={},t._events={}}(this.TANK=this.TANK||{});